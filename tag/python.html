<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>carlcarl's blog - python</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">carlcarl's blog </a></h1>
                <nav><ul>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/1331/python-sphinx-simple-example/">Python Sphinx simple example</a></h1>
<footer class="post-info">
        <abbr class="published" title="2013-10-02T02:32:00">
                三 02 10月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/python.html">python</a>. </p>
<p>tags: <a href="/tag/python.html">python</a><a href="/tag/sphinx.html">sphinx</a></p>
</footer><!-- /.post-info --><p>查了很多資料，遇到一堆鬼打牆問題，終於弄成我要的樣子了，不過其實也沒有加多少東西，只是基本的設定一直搞不定
orz。</p>
<!--more-->

<hr />
<p>下面是一開始的 project 結構，接著會利用 <code>sphinx</code> 在根目錄下建立 <code>doc</code>
這個目錄：</p>
<h2>Project 目錄架構</h2>
<div class="highlight"><pre>.
├── CHANGES.txt
├── MANIFEST.in
├── README.rst
├── test
│   ├── __init__.py
│   └── test.py
├── requirements.txt
└── setup.py
</pre></div>


<hr />
<h2>安裝並產生設定</h2>
<p>首先先安裝 <code>sphinx</code>(ex: <code>pip install sphinx</code>)，接著在 project
根目錄下輸入 <code>sphinx-quickstart</code>，設定步驟如下：</p>
<div class="highlight"><pre>Welcome to the Sphinx 1.1.3 quickstart utility.

Please enter values for the following settings (just press Enter to
accept a default value, if one is given in brackets).

Enter the root path for documentation.
&gt; Root path for the documentation [.]: doc

You have two options for placing the build directory for Sphinx output.
Either, you use a directory &quot;_build&quot; within the root path, or you separate
&quot;source&quot; and &quot;build&quot; directories within the root path.
&gt; Separate source and build directories (y/N) [n]:

Inside the root directory, two more directories will be created; &quot;_templates&quot;
for custom HTML templates and &quot;_static&quot; for custom stylesheets and other static
files. You can enter another prefix (such as &quot;.&quot;) to replace the underscore.
&gt; Name prefix for templates and static dir [_]:

The project name will occur in several places in the built documentation.
&gt; Project name: test
&gt; Author name(s): carlcarl

Sphinx has the notion of a &quot;version&quot; and a &quot;release&quot; for the
software. Each version can have multiple releases. For example, for
Python the version is something like 2.5 or 3.0, while the release is
something like 2.5.1 or 3.0a1.  If you don&#39;t need this dual structure,
just set both to the same value.
&gt; Project version: 0.0.1
&gt; Project release [0.0.1]:

The file name suffix for source files. Commonly, this is either &quot;.txt&quot;
or &quot;.rst&quot;.  Only files with this suffix are considered documents.
&gt; Source file suffix [.rst]:

One document is special in that it is considered the top node of the
&quot;contents tree&quot;, that is, it is the root of the hierarchical structure
of the documents. Normally, this is &quot;index&quot;, but if your &quot;index&quot;
document is a custom template, you can also set this to another filename.
&gt; Name of your master document (without suffix) [index]:

Sphinx can also add configuration for epub output:
&gt; Do you want to use the epub builder (y/N) [n]:

Please indicate if you want to use one of the following Sphinx extensions:
&gt; autodoc: automatically insert docstrings from modules (y/N) [n]: y
&gt; doctest: automatically test code snippets in doctest blocks (y/N) [n]:
&gt; intersphinx: link between Sphinx documentation of different projects (y/N) [n]:
&gt; todo: write &quot;todo&quot; entries that can be shown or hidden on build (y/N) [n]:
&gt; coverage: checks for documentation coverage (y/N) [n]:
&gt; pngmath: include math, rendered as PNG images (y/N) [n]:
&gt; mathjax: include math, rendered in the browser by MathJax (y/N) [n]:
&gt; ifconfig: conditional inclusion of content based on config values (y/N) [n]:
&gt; viewcode: include links to the source code of documented Python objects (y/N) [n]:

A Makefile and a Windows command file can be generated for you so that you
only have to run e.g. `make html&#39; instead of invoking sphinx-build
directly.
&gt; Create Makefile? (Y/n) [y]:
&gt; Create Windows command file? (Y/n) [y]: n

Creating file doc/conf.py.
Creating file doc/index.rst.
Creating file doc/Makefile.

Finished: An initial directory structure has been created.

You should now populate your master file doc/index.rst and create other documentation
source files. Use the Makefile to build the docs, like so:
   make builder
where &quot;builder&quot; is one of the supported builders, e.g. html, latex or linkcheck.
</pre></div>


<p>比較要注意的是一開始的路徑輸入 <code>doc</code> 表示要在當前目錄的 <code>doc</code>
底下建立文件。 <code>autodoc</code> 這個記得選 <code>y</code>。因為不是用 Windows，所以
<code>Windows command file</code> 這個選項我就選 <code>n</code> 了。輸入完後會建立 <code>doc</code>
這個目錄。</p>
<hr />
<h2>產生 API 設定文件</h2>
<p>在 project 根目錄下輸入：<code>sphinx-apidoc -o doc/api test</code>，會將 API
設定文件放到 <code>doc/api</code> 底下。</p>
<hr />
<h2>修改設定檔</h2>
<p>接著進入 <code>doc</code> 這個目錄 (<code>cd doc</code>)，修改 <code>index.rst</code> 以及 <code>conf.py</code>。</p>
<h3>conf.py</h3>
<p>首先是 <code>conf.py</code>。在 <code>import sys, os</code> 下面加上
<code>sys.path.insert(0, os.path.abspath('..'))</code> 即可，這邊是將 project 的
path 加入 <code>sys.path</code> 當中，不然 sphinx 會找不到。</p>
<h3>index.rst</h3>
<p>這邊是我整個設定檔：</p>
<div class="highlight"><pre><span class="cp">.. test documentation master file, created by</span>
<span class="cp">   sphinx-quickstart on Wed Oct  2 00:41:51 2013.</span>
<span class="cp">   You can adapt this file completely to your liking, but it should at least</span>
<span class="cp">   contain the root `toctree` directive.</span>

<span class="gh">Welcome to test&#39;s documentation!</span>
<span class="gh">======================================</span>

<span class="na">:doc:</span><span class="nv">`API Documentation &lt;api/test&gt;`</span>

<span class="p">..</span> <span class="ow">include</span><span class="p">::</span> ../README.rst


<span class="gh">Indices and tables</span>
<span class="gh">==================</span>

<span class="m">*</span> <span class="na">:ref:</span><span class="nv">`genindex`</span>
<span class="m">*</span> <span class="na">:ref:</span><span class="nv">`modindex`</span>
<span class="m">*</span> <span class="na">:ref:</span><span class="nv">`search`</span>

<span class="p">..</span> <span class="ow">toctree</span><span class="p">::</span>
   <span class="nc">:hidden:</span>

   api/modules
</pre></div>


<p><code>API Documentation</code> 這段是程式的 API 連結。如果在 project 根目錄有
<code>README.rst</code> 的話，可以如上面這樣 include 進來。最下面的 <code>toctree</code> 到
<code>api/modules</code> 這段是因為 <code>sphinx-apidoc</code> 會產生一個 <code>modules.rst</code>
檔案，如果沒加到 <code>toctree</code> 會有警告，這邊就把它加進來，然後設隱藏，至於
<code>toctree</code> 是啥，可以參考 <a href="http://sphinx-doc.org/concepts.html">這個連結</a>，算是一個目錄架構這樣。</p>
<hr />
<h2>產生 html</h2>
<p>在 <code>doc</code> 底下輸入 <code>make html</code>，產生的 html 會放在 <code>_build/html</code>
下，到這裡就算大功告成了。</p>
<hr />
<h2>其他遇到的問題</h2>
<h3>為啥不在 rst 檔案中加入 automodule 的設定，而是用 <code>sphinx-apidoc</code> 產生 API 文件？</h3>
<p>因為 automodule 做不到 recursive 尋找 submodule。相關討論連結如下：</p>
<p><a href="http://stackoverflow.com/questions/4616693/automatically-generating-documentation-for-all-python-package-contents">Automatically Generating Documentation for All Python Package Contents</a><br />
<a href="http://stackoverflow.com/questions/2701998/sphinx-autodoc-is-not-automatic-enough">Sphinx autodoc is not automatic enough</a><br />
<a href="http://stackoverflow.com/questions/11508290/sphinx-using-automodule-to-find-submodules">Sphinx, using automodule to find submodules</a></p>
<h3>sphinx-build option -b not recognized</h3>
<p>這個錯誤的直接原因是因為 module 裡面有用 <code>argparse</code> 這類的 module，然後
<code>sphinx-build</code> 執行時有 <code>-b</code> 這個參數，傳進去之後就炸了。但是一般來說
module 裡用 <code>argparse</code>，本身不是個問題，問題是 sphinx
為啥執行了這段程式，有幾個可能的原因：</p>
<ol>
<li>module 裡沒用 <code>if __name__ == '__main__':</code> 這段，而是直接執行。</li>
<li>sphix-apidoc 讀取的目錄裡包含 <code>setup.py</code>，即使 module
    裡有用上面的判斷包起來，還是會全執行。</li>
</ol>
<p>所以我一開始才會用 <code>sphinx-apidoc -o doc/api test</code> 而不是
<code>sphinx-apidoc -o doc/api .</code>，就是要避開
<code>setup.py</code>。下面是找到的相關連結：</p>
<p><a href="http://stackoverflow.com/questions/6912025/is-optionparser-in-conflict-with-sphinx">Is OptionParser in conflict with sphinx?</a><br />
<a href="http://stackoverflow.com/questions/14769962/how-should-i-solve-the-conflict-of-optionparser-and-sphinx-build-in-a-large-proj">How should I solve the conflict of OptionParser and sphinx-build in a large project?</a><br />
<a href="http://www.mail-archive./om/sphinx-dev@googlegroups.com/msg05521.html">Re: sphinx-dev option -b not recognized?</a></p>
<h3>WARNING: document isn't included in any toctree</h3>
<p>參閱 <a href="http://stackoverflow.com/questions/1690757/location-of-sphinx-sources-for-my-notes">Location of Sphinx sources for my notes</a></p>
<hr />
<h2>參考資料</h2>
<p><a href="http://raxcloud.blogspot.tw/2013/02/documenting-python-code-using-sphinx.html">Documenting python code using sphinx and github</a><br />
<a href="http://stackoverflow.com/questions/10324393/sphinx-build-fail-autodoc-cant-import-find-module">sphinx-build fail - autodoc can't import/find module</a><br />
<a href="http://scienceoss.com/minimal-sphinx-setup-for-autodocumenting-python-modules/">http://scienceoss.com/minimal-sphinx-setup-for-autodocumenting-python-modules/</a><br />
<a href="http://api.mongodb.org/python/current/">Example: PyMongo documentation</a></p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/865/python-decorate-method-inside-class/" rel="bookmark"
                           title="Permalink to Python decorate method inside class">Python decorate method inside class</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-06-02T04:45:00">
                日 02 6月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/python.html">python</a>. </p>
<p>tags: <a href="/tag/class.html">class</a><a href="/tag/decorate.html">decorate</a><a href="/tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p>簡易版的可以直接參考
<a href="http://stackoverflow.com/questions/1367514/how-to-decorate-a-method-inside-a-class">http://stackoverflow.com/questions/1367514/how-to-decorate-a-method-inside-a-class</a>。<br />
<!--more--><br />
以我的例子來說，我需要對某些 method 加上 retry
的機制，除了需要有參數外，還希望能夠把 decorate method 放在 class
裡頭，這樣我才能呼叫 class 裡頭另外的 method。以下是簡單的例子：</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">Test</span><span class="p">():</span>

    <span class="k">def</span> <span class="nf">retry</span><span class="p">(</span><span class="n">tries</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">deco_retry</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="c"># f is the method decorated</span>
            <span class="k">def</span> <span class="nf">f_retry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="n">f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs ...</span></pre></div>
                <a class="readmore" href="/865/python-decorate-method-inside-class/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/852/python-cant-use-a-string-pattern-on-a-bytes-like-object/" rel="bookmark"
                           title="Permalink to Python: can't use a string pattern on a bytes-like object">Python: can't use a string pattern on a bytes-like object</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-05-23T16:25:00">
                四 23 5月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/python.html">python</a>. </p>
<p>tags: <a href="/tag/encode.html">encode</a><a href="/tag/httplib.html">httplib</a><a href="/tag/json.html">json</a><a href="/tag/python.html">python</a><a href="/tag/python2.html">python2</a><a href="/tag/python3.html">python3</a></p>
</footer><!-- /.post-info -->                <p>最近嘗試將 Python2 的程式轉成
Python3，看起來好像很順利，不過在執行的時候就出現了 Excepion
囧，內容就是
<code>can't use a string pattern on a bytes-like object</code>，看了一下，是 <code>json</code>
的 <code>loads</code> 在轉<code>httplib</code> <code>read</code> 的 output 出現問題，而原來在 Python2
中並不會出現這個問題，原來程式如下：<br />
<!--more--></p>
<div class="highlight"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_connect</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>


<p>後來查了一下資料才發現，這邊的 <code>read</code>，似乎讀出的資料是 <code>byte</code> 的
type，還需要做 encode ...</p>
                <a class="readmore" href="/852/python-cant-use-a-string-pattern-on-a-bytes-like-object/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/827/appfog-deploy-pyramid/" rel="bookmark"
                           title="Permalink to appfog deploy pyramid">appfog deploy pyramid</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-04-14T23:45:00">
                日 14 4月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/cloud-python.html">cloud, python</a>. </p>
<p>tags: <a href="/tag/appfog.html">appfog</a><a href="/tag/pyramid.html">pyramid</a><a href="/tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p>這篇是參考
<a href="http://antoineleclair.ca/2012/08/28/deploying-a-pyramid-app-on-appfog/">http://antoineleclair.ca/2012/08/28/deploying-a-pyramid-app-on-appfog/</a>
這篇所講的，其實他講的就差不多了，但是漏掉了一些細節，所以幫忙補完一下。<br />
<!--more--><br />
<a href="https://www.appfog.com/">appfog</a> 的 deploy 相對 <a href="https://www.openshift.com/">openshift</a> 來說，算是簡單很多 (不過
openshift 也有一堆 quickstart 的 github repo 可以直接用就是)，以
<a href="http://www.pylonsproject.org/">pyramid</a> 來講，主要就是在 project 根目錄新增一個 <code>wsgi.py</code>
的檔案，內容引用文章連結內的程式：</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">paste.deploy</span> <span class="kn">import</span> <span class="n">loadapp</span>

<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&#39;python setup.py develop ...</span></pre></div>
                <a class="readmore" href="/827/appfog-deploy-pyramid/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/598/virtualenvwrapper-setting/" rel="bookmark"
                           title="Permalink to virtualenvwrapper setting">virtualenvwrapper setting</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-08-28T00:01:00">
                二 28 8月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/python.html">python</a>. </p>
<p>tags: <a href="/tag/python.html">python</a><a href="/tag/virtualenvwrapper.html">virtualenvwrapper</a></p>
</footer><!-- /.post-info -->                <p>最近為了方便，加了幾個 virtualenvwrapper 的設定。<br />
<!--more--></p>
<h3>使用 <code>mkvirtualenv</code> 建立 virtualenv 時，自動建立資料夾並移到資料夾位置下。</h3>
<p>在 <code>~/.virtualenv/postmkvirtualenv</code>裡加入：</p>
<div class="highlight"><pre><span class="nv">proj_name</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VIRTUAL_ENV</span>|awk -F<span class="s1">&#39;/&#39;</span> <span class="s1">&#39;{print $NF}&#39;</span><span class="k">)</span>

<span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;~/Projects/$proj_name&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span>mkdir ~/Projects/<span class="nv">$proj_name</span>
<span class="k">fi</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;${PWD##*/}&quot;</span> !<span class="o">=</span> <span class="s2">&quot;~/Projects/$proj_name&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span><span class="nb">cd</span> ~/Projects/<span class="nv">$proj_name</span>
<span class="k">fi</span>
</pre></div>


<p>其中，把 <code>Projects</code> 換成你的 project 位置。</p>
<hr />
<h3>輸入 <code>workon 你的project</code> 時，自動切換至 ...</h3>
                <a class="readmore" href="/598/virtualenvwrapper-setting/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/515/chakra-vim-not-support-pythoncomplete/" rel="bookmark"
                           title="Permalink to Chakra vim not support pythoncomplete">Chakra vim not support pythoncomplete</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-06-17T22:47:00">
                日 17 6月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/linux-python.html">linux, python</a>. </p>
<p>tags: <a href="/tag/chakra.html">chakra</a><a href="/tag/python.html">python</a><a href="/tag/vim.html">vim</a></p>
</footer><!-- /.post-info -->                <p>最近在 Chakra 上用 vim 寫 python
的時候才突然發現這個問題，原因似乎是因為 vim 在編譯的時候沒有加上 python
的編譯參數，解決這個問題很簡單，只要改安裝 <code>vim-qt-git</code> 就 OK
了，因為它所提供的 vim 是有支援 pythoncomplete 的。vim-qt-git
本身包含一套完整的 vim 以及加上 GUI 的套件，所以安裝的時候會要求將原本的
vim 移除掉，允許移除後，就能順利安裝並使用 pythoncomplete 的補完功能了。</p>
<p>參考網址：<br />
<a href="https://bbs.archlinux.org/viewtopic.php?id=122091">https://bbs.archlinux.org/viewtopic.php?id=122091</a><br />
<a href="https://wiki.archlinux.org/index.php/Vim">https://wiki.archlinux.org/index ...</a></p>
                <a class="readmore" href="/515/chakra-vim-not-support-pythoncomplete/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/444/django-name-array/" rel="bookmark"
                           title="Permalink to Django name array">Django name array</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-05-09T17:38:00">
                三 09 5月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/python.html">python</a>. </p>
<p>tags: <a href="/tag/django.html">django</a><a href="/tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p>在寫 php 的時候，如果想傳多個 checkbox 的值的話，常會在 html
裏面設定這些 checkbox 的 name 為
<code>list[]</code>，也就是會加個 <code>[]</code> 在名稱後面，在 php 處理的時候就可以利用
<code>$_POST['list']</code> 取出這個 array。</p>
<p>而如果是 django name array
要處理的話，方式有點不太一樣，它並不會自動去判斷 <code>[]</code>，所以在 django
這邊還是必須讀 <code>list[]</code> 這樣的名稱，這也表示在 html
裡，<code>[]</code> 是可以不加的，但是我還是建議加上就是了，至少這樣我覺得會比較好懂。<br />
<!--more--><br />
來看一下簡單的範例：</p>
<p>html</p>
<div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">name=</span><span class="s">&quot;list[]&quot;</span> <span class="na">value=</span><span class="s">&quot;value ...</span></pre></div>
                <a class="readmore" href="/444/django-name-array/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/342/django-ajax-file-upload/" rel="bookmark"
                           title="Permalink to Django ajax file upload">Django ajax file upload</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-04-03T21:56:00">
                二 03 4月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js-python.html">js, python</a>. </p>
<p>tags: <a href="/tag/ajax.html">ajax</a><a href="/tag/ajaxfileupload.html">ajaxfileupload</a><a href="/tag/csrf.html">csrf</a><a href="/tag/django.html">django</a><a href="/tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p>原本以為很簡單可以完成的東西，結果花了我不少時間解決囧。</p>
<p>Ajax 檔案上傳我用的是 <a href="http://www.phpletter.com/Our-Projects/AjaxFileUpload/">ajaxfileupload</a> 這個 jQuery 套件，問題在於
Django 會檢查 csrf 的問題，如果我不在 settings.py 裡的
<code>MIDDLEWARE_CLASSES</code> 加上
<code>django.middleware.csrf.CsrfViewMiddleware</code>，上傳會出現 syntax
error，如果我加上了，則是會跟我說 csrf token 找不到。</p>
<p>後來找到的解決辦法就是在 views.py 裡拿到 csrf token 並傳到 template
中，然後再改寫 ajaxfileupload.js 中的內容，讓它支援傳送參數，接著將 csrf
token 當作參數傳送回去就 OK ...</p>
                <a class="readmore" href="/342/django-ajax-file-upload/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/335/python-documentation-epydoc/" rel="bookmark"
                           title="Permalink to python documentation: epydoc">python documentation: epydoc</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-04-01T16:05:00">
                日 01 4月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/python.html">python</a>. </p>
<p>tags: <a href="/tag/epydoc.html">epydoc</a><a href="/tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p><a href="http://epydoc.sourceforge.net/index.html">epydoc</a> 是利用 parse python 的程式來製作文件，文件的類型像是一般的 html 和 pdf 都能產生。我個人是比較偏好 html 的格式囉，它的 html 樣板跟 Javadoc 的配置差不多，比較習慣。</p>
<p>它 parse 程式的方法主要是利用 method 一開始的 <code>"""</code> 註解，不習慣寫的人可以參考它的 <a href="http://epydoc.sourceforge.net/fields.html#fields">欄位官方範例</a>。</p>
<p>首先要先安裝 <code>epydoc</code>，在官方網站上沒講到 ubuntu
的安裝包，用 <code>apt-get</code> 也找不到，後來試看看 <code>pip install epydoc</code> 就 OK
了。這邊有點要注意的是，如果你的 project
是在 <code>virtualenv</code> 環境下的話，建議將 <code>epydoc ...</code></p>
                <a class="readmore" href="/335/python-documentation-epydoc/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/135/dotcloud-django-admin-login-error/" rel="bookmark"
                           title="Permalink to DotCloud Django admin login error">DotCloud Django admin login error</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2011-11-27T16:53:00">
                日 27 11月 2011
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/python.html">python</a>. </p>
<p>tags: <a href="/tag/django.html">django</a><a href="/tag/dotcloud.html">Dotcloud</a><a href="/tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p>在建置好 admin 相關的設定和 static file 路徑後，終於進到輸入 admin
帳密的畫面了，但是按鈕連結卻是錯誤的，看了一下 source code
的部份，「app_path」這個變數似乎有問題。</p>
<p>找了好久都找不到解決的辦法，後來看到一篇文章發現似乎是 DotCloud
本身的問題。<br />
[http://stackoverflow.com/questions/7057111 ][]<br />
如果真的想試試看的話，可以 ssh 到你的 app.www，然後使用 vim：</p>
<div class="highlight"><pre>vim env/lib/python2.6/site-packages/django/contrib/admin/templates/admin/login.html
</pre></div>


<p>將 <code>{{ app_path }}</code> 改為 <code>/admin ...</code></p>
                <a class="readmore" href="/135/dotcloud-django-admin-login-error/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
            </ol><!-- /#posts-list -->
<p class="paginator">
    Page 1 / 1
</p>
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>