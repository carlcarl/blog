<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>carlcarl's blog - js</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">carlcarl's blog </a></h1>
                <nav><ul>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/1262/javascript-parseint-and-number/">Javascript parseInt and Number</a></h1>
<footer class="post-info">
        <abbr class="published" title="2013-08-07T15:31:00">
                三 07 8月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/number.html">Number</a><a href="/tag/parseint.html">parseInt</a></p>
</footer><!-- /.post-info --><p>這個是查資料時看到的 benchmark <a href="http://jsperf.com/performance-of-parseint">performance of parseInt()</a></p>
<p>簡單歸納幾點：</p>
<ol>
<li><code>parseInt</code> 基本上幾乎是比 <code>Number</code>
    還要快的，兩者雖然用法有點不同，不過純粹做轉換的話，<code>parseInt</code>
    會比較快。</li>
<li><code>parseInt('4')</code> 跟 <code>parseInt('4', 10)</code>
    在不同瀏覽器的效能也不一樣。不過直覺來看，感覺應該是 <code>parseInt('4')</code>
    會比較快說，因為不需要驗證參數。就個人來說，還是直接 <code>parseInt('4')</code>
    就好。</li>
<li>new 會帶來多的 overhead，所以 new Number 又比 Number 慢。</li>
</ol>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/1113/javascript-mutationobserver/" rel="bookmark"
                           title="Permalink to Javascript MutationObserver">Javascript MutationObserver</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-07-03T18:46:00">
                三 03 7月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/mutationobserver.html">MutationObserver</a></p>
</footer><!-- /.post-info -->                <p>最近看到 Aol Reader release，試用了一下，感覺還滿不錯的，但是右邊的廣告實在很礙眼，就算用
adblock 擋掉，右邊還是會留空，想說都沒寫過 browser 的 extension
，所以就拿這個來練功啦～，不然其實寫 userscript 也可以就是。要弄的
extension 以 Opera 和 Chrome 為主，因為兩個基本上架構可以共通，寫起來 CP
值比較高 XD。</p>
<!--more-->

<p>本來想說直接綁定 <code>window.onload</code> 在裡面做就好了，不過後來發現 Aol Reader
在 <code>onload</code> 之後還會有個它自己 loading
的頁面，處理起來就變麻煩很多，因為除了要觀察 dom 來判斷何時才算真的
ready 以外，另外就是 ...</p></!--more-->
                <a class="readmore" href="/1113/javascript-mutationobserver/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/1049/chrome-cpu-profiler-program/" rel="bookmark"
                           title="Permalink to chrome cpu profiler program">chrome cpu profiler program</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-06-17T15:26:00">
                一 17 6月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/chrome.html">chrome</a></p>
</footer><!-- /.post-info -->                <p>查了一下 chrome 裡 cpu profiler 裡的 program 代表啥意思，像有人說是整個
js code 的 root，不過看了一下其他的意見，感覺比較像是 native code
所花的時間，包括 DOM 操作，gc 等一堆雜事等。舉個例子來說，假如你是要看你
function 處理一堆 array 結構的校能的話，就可以不需要理這欄。</p>
<p>參考資料：<br />
<a href="http://stackoverflow.com/questions/9494228/slow-javascript-execution-in-chrome-profiler-yields-program">Slow javascript execution in chrome, profiler yields (program)</a><br />
<a href="https://groups.google.com/forum/?fromgroups#!topic/chromium-discuss/02CEYDcuO18">What does (program) signify in the Chrome profiler?</a><br />
<a href="http://stackoverflow.com/questions/3847954/chrome-debugger-what-is-program-in-the-profiler">Chrome debugger - what ...</a></p>
                <a class="readmore" href="/1049/chrome-cpu-profiler-program/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/1023/html5-canvas-double-buffering/" rel="bookmark"
                           title="Permalink to html5 canvas double buffering">html5 canvas double buffering</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-06-16T19:25:00">
                日 16 6月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/canvas.html">canvas</a><a href="/tag/html5.html">html5</a></p>
</footer><!-- /.post-info -->                <p>因為之前寫 java 的經驗，讓我以為在 html5 的 canvas 上也要自己實作 double
buffering，但是在我後來實作後發現，好像哪裡怪怪的，因為其實原本就沒有在閃的感覺了，所以加了
double buffering 好像也沒啥差，重點是 performance 下降很多......。</p>
<!--more-->

<p>後來花了一些時間找資料，我得到的結論－是大部分的情況，不需要自己做
double buffering，因為瀏覽器會很聰明的幫你做。但是它怎麼判斷什麼時候該把
buffer 的部分 render 上去呢？以下是我的鍵盤猜測：</p>
<p>因為現在大多數的螢幕更新頻率都是 60Hz，也就是說大概每 16 ms
就會刷新一次螢幕，而瀏覽器本身在刷新的頻率可能也會接近這個時間，但是有沒有比較高就不知道了，因為你所看到的可能會被你螢幕的更新頻率所限制，就算瀏覽器刷新頻率是
1000Hz，反正一般的銀幕也看不出來:P。</p>
<p>以一個簡單的例子來實驗，假如我在一開始把一個方形塗上顏色然後 clear
掉 ...</p></!--more-->
                <a class="readmore" href="/1023/html5-canvas-double-buffering/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/897/jslint-note/" rel="bookmark"
                           title="Permalink to JSLint note">JSLint note</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-06-08T01:36:00">
                六 08 6月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/jslint.html">jslint</a></p>
</footer><!-- /.post-info -->                <p>記錄一些錯誤的處理方式。 <!--more--></p>
<h3>1. Document was used before it was defined</h3>
<p>因為 JSLint 只是用來分析一般的 javascript code，像 <code>document</code>
這種在瀏覽器上才有用的 global variable，就要在檔案開始加個宣告：</p>
<div class="highlight"><pre><span class="cm">/* jslint browser:true */</span>
</pre></div>


<h3>2. This is an ES5 feature</h3>
<p>比較新的
feature。在一些舊瀏覽器可能會有問題，如果不想管那些舊瀏覽器的話，簡單加上以下這樣就可解決：</p>
<div class="highlight"><pre><span class="cm">/* jslint es5: true */</span>
</pre></div>


<h3>3. Move the invocation into the parens that contain the function</h3>
<p>改成用括弧將 function ...</p>
                <a class="readmore" href="/897/jslint-note/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/813/ajax-with-mobile-keyboard-go-button/" rel="bookmark"
                           title="Permalink to ajax with mobile keyboard go button">ajax with mobile keyboard go button</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-04-07T22:58:00">
                日 07 4月 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/ajax.html">ajax</a><a href="/tag/mobile.html">mobile</a></p>
</footer><!-- /.post-info -->                <p>最近弄 ajax 在手機上測的時候發現按 keyboard 上的 go 按鈕不會自動
submit，所以看了一下是怎麼回事。找了一些資料加上自己測試了一下，發現原來
go 按鈕跟 enter 是一樣的 event。</p>
<p>我最後決定的做法是將原本 ajax 要 submit 的 部分先用 form tag
包起來，ajax 的按鈕則改成 <code>&lt;button type="submit"&gt;&lt;/button&gt;</code>，<code>type</code> 用
<code>submit</code> 可以使得在按 enter 或是 手機上按 go 的時候能 trigger submit 的
event，這邊用 <code>&lt;input&gt;</code> 也是可以，不過因為我有用一些 icon 在按鈕中 ...</p>
                <a class="readmore" href="/813/ajax-with-mobile-keyboard-go-button/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/606/test-kineticjs-apply-canvas/" rel="bookmark"
                           title="Permalink to Test KineticJS apply canvas">Test KineticJS apply canvas</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-09-04T01:54:00">
                二 04 9月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/canvas.html">canvas</a><a href="/tag/kineticjs.html">kineticjs</a></p>
</footer><!-- /.post-info -->                <p>寫起來跟以前寫 Java 作類似東西的感覺很像，東西基本上都已經用物件包好，然後還有提供 layer
讓你可以很方便的在不同 layer 放你要的物件。<br />
<!--more--><br />
我嘗試把我原本<a href="https://github.com/carlcarl/CaGo/blob/master/js/cago.js">播放棋譜</a>的 canvas 改成套用 KineticJS，不過後來發現，因為我的 canvas
操作沒很複雜，所以真的是太大材小用了...。</p>
<p>以可讀性來講，因為我大部分畫 canvas 都是放在一個 function 裡，大致用幾個註解分幾個段落，其實就知道各部份的流程，換成物件的方式後，整個 function 感覺並沒有更好讀，而且程式沒有比較短=.=。</p>
<p>然後我用一個固定的測試流程來作測試(這個流程不包括前面的 js file loading，是讀完後才開始作操作測試)，測試的結果原本是 200ms，換成 KineticJS 之後是 800ms，整個很不划算 ~.~。</p>
<p>雖然 KineticJS 有提供 layer ...</p>
                <a class="readmore" href="/606/test-kineticjs-apply-canvas/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/537/javascript-library-simple-structure/" rel="bookmark"
                           title="Permalink to Javascript Library simple structure">Javascript Library simple structure</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-07-23T02:03:00">
                一 23 7月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/javascript.html">javascript</a></p>
</footer><!-- /.post-info -->                <p>之前在找 Javascript 這方面的 library
該怎麼寫，看了一些資料，覺得以下這種方式不錯<br />
<!--more--></p>
<div class="highlight"><pre><span class="c1">// library example</span>
<span class="kd">var</span> <span class="nx">animal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nb">window</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;tom&#39;</span><span class="p">;</span> <span class="c1">// private variable</span>

    <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;getName&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">name</span><span class="p">;}</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="nx">API</span><span class="p">;</span>
<span class="p">}(</span><span class="nx">windows</span><span class="p">);</span>

<span class="nx">animal</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span> <span class="c1">// call API</span>
</pre></div>


<p>這樣寫法的優點：</p>
<ul>
<li>透過將這個 library 當作一個物件並呼叫其中的
    function，使用上較不會跟其他 library function 混淆，也較好
    maintain。</li>
<li>使用這個 library 的時候，也能夠保護到內部的 private variable
    不被直接做 access ...</li></ul>
                <a class="readmore" href="/537/javascript-library-simple-structure/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/525/html-script-speed-up-with-defer/" rel="bookmark"
                           title="Permalink to HTML script speed up with defer">HTML script speed up with defer</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-07-06T03:49:00">
                五 06 7月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/javascript.html">javascript</a></p>
</footer><!-- /.post-info -->                <p>在 <a href="http://blog.xuite.net/vexed/tech/61308318">script tag 屬性 async defer 差別</a> 這邊看到了 script tag 有 async
和 defer 的用法，所以就來試試看。大致測試了一下，速度的確有快了一些(大概加快50 ~ 100ms
左右吧XD)。以下大概講一下我的測試範例內容：</p>
<!--more-->

<div class="highlight"><pre><span class="c">&lt;!-- </span>
<span class="c">這是原本的程式</span>
<span class="c">a-b.js 需要 a.js, 而 a-c.js 需要 a.js, 這是這 3 個 js 檔的相依關係</span>
<span class="c">最後會從 a-c.js 裡呼叫 library 來執行</span>
<span class="c">由於 async 屬性並不適合用來處理有相依性的 js 檔案 ...</span></pre></div></!--more-->
                <a class="readmore" href="/525/html-script-speed-up-with-defer/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/438/javascript-check-if-array-and-empty/" rel="bookmark"
                           title="Permalink to Javascript check if array and empty">Javascript check if array and empty</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-05-09T04:24:00">
                三 09 5月 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/carlcarl.html">carlcarl</a>
        </address>
<p>In <a href="/category/js.html">js</a>. </p>
<p>tags: <a href="/tag/array.html">array</a><a href="/tag/empty.html">empty</a><a href="/tag/javascript.html">javascript</a></p>
</footer><!-- /.post-info -->                <p>列出一些我覺得比較 OK 的方法，至於其他還有一些方法可以參考最下方的網址。  
判斷是否為 array 的方式：</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">xxx</span> <span class="o">=</span> <span class="p">[];</span>

<span class="c1">// 第1種：先用 if 判斷瀏覽器是否支援此method 然後再執行</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>

<span class="c1">// 第2種</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">xxx</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object Array]&#39;</span>

<span class="c1">// 第3種</span>
<span class="mi">3</span><span class="p">.</span> <span class="nx">xxx</span> <span class="k">instanceof</span> <span class="nb">Array</span>
</pre></div>


<p>判斷 array 是否為 empty的方式：</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">xxx</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">if</span><span class="p">(</span><span class="nx">xxx</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Array is empty&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>另外如果還要判斷在 array ...</p>
                <a class="readmore" href="/438/javascript-check-if-array-and-empty/">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
            </ol><!-- /#posts-list -->
<p class="paginator">
    Page 1 / 2
        <a href="/category/js2.html">&raquo;</a>
</p>
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>